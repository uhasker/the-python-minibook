
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Chapter 7. Files &#8212; The Python Minibook</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chapter 8. Modules and packages" href="../8-modules-and-packages/chapter.html" />
    <link rel="prev" title="Chapter 6. Control flow" href="../6-control-flow/chapter.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">The Python Minibook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    The Python minibook
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1-installation/chapter.html">
   Chapter 1. Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2-variables-data-types-and-operators/chapter.html">
   Chapter 2. Variables, data types and operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3-functions/chapter.html">
   Chapter 3. Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4-classes/chapter.html">
   Chapter 4. Classes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5-iterables/chapter.html">
   Chapter 5. Iterables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../6-control-flow/chapter.html">
   Chapter 6. Control flow
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Chapter 7. Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../8-modules-and-packages/chapter.html">
   Chapter 8. Modules and packages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../9-the-project/chapter.html">
   Chapter 9. The project
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/uhasker/the-python-minibook/main?urlpath=tree/src/7-files/chapter.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/uhasker/the-python-minibook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/uhasker/the-python-minibook/issues/new?title=Issue%20on%20page%20%2Fsrc/7-files/chapter.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/src/7-files/chapter.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-a-text-file">
   Read a text file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-with-statement">
   The “with” statement
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-to-a-file">
   Writing to a file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#escape-characters">
   Escape characters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encodings">
   Encodings
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Chapter 7. Files</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-a-text-file">
   Read a text file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-with-statement">
   The “with” statement
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-to-a-file">
   Writing to a file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#escape-characters">
   Escape characters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#encodings">
   Encodings
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-7-files">
<h1>Chapter 7. Files<a class="headerlink" href="#chapter-7-files" title="Permalink to this headline">#</a></h1>
<p>In this chapter we will cover how to read and write files. We will also cover a topic that is rarely discussed in introductory programming books, but is should be understood by every working programmer - <em>encodings</em>.</p>
<section id="read-a-text-file">
<h2>Read a text file<a class="headerlink" href="#read-a-text-file" title="Permalink to this headline">#</a></h2>
<p>Let’s create a text file <code class="docutils literal notranslate"><span class="pre">example.txt</span></code> with the following content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Roses</span> <span class="n">are</span> <span class="n">red</span><span class="o">.</span>
<span class="n">Violets</span> <span class="n">aren</span><span class="s1">&#39;t blue.</span>
<span class="n">It</span><span class="s1">&#39;s literally in the name.</span>
<span class="n">They</span><span class="s1">&#39;re called violets.</span>
</pre></div>
</div>
<p>We can read the file using the <code class="docutils literal notranslate"><span class="pre">open</span></code> function. This function returns a <strong>file object</strong> which allows access to the underlying file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.txt&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;_io.TextIOWrapper name=&#39;example.txt&#39; mode=&#39;r&#39; encoding=&#39;UTF-8&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We can read the content of the file using the <code class="docutils literal notranslate"><span class="pre">read</span></code> method of the <code class="docutils literal notranslate"><span class="pre">file</span></code> object. The <code class="docutils literal notranslate"><span class="pre">read</span></code> method returns the entire content of the file as a regular string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Roses are red.
Violets aren&#39;t blue.
It&#39;s literally in the name.
They&#39;re called violets.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>str
</pre></div>
</div>
</div>
</div>
<p>We also need to <em>close</em> the file to free up the resouces consumed by the file object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s check that the file is really closed by inspecting the <code class="docutils literal notranslate"><span class="pre">closed</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span><span class="o">.</span><span class="n">closed</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>Trying to call <code class="docutils literal notranslate"><span class="pre">read</span></code> on a closed file object will result in an error:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="ne">ValueError</span>: I/O operation on closed file.
</pre></div>
</div>
</div>
</div>
<p>To summarize, we first need to <em>open</em> a file resulting in a <em>file object</em>. We are then able to perform operation on that <em>file object</em> like reading the content of the file. Finally we need to <em>close</em> the file object.</p>
<p>We will now look at this workflow in more detail.</p>
</section>
<section id="the-with-statement">
<h2>The “with” statement<a class="headerlink" href="#the-with-statement" title="Permalink to this headline">#</a></h2>
<p>To simplify working with files, we can use the <code class="docutils literal notranslate"><span class="pre">with</span></code> statement which will automatically close the file:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    
    <span class="c1"># The file is automatically closed, i.e. there is no need to call file.close()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Roses are red.
Violets aren&#39;t blue.
It&#39;s literally in the name.
They&#39;re called violets.
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-to-a-file">
<h2>Writing to a file<a class="headerlink" href="#writing-to-a-file" title="Permalink to this headline">#</a></h2>
<p>Writing to a file works similarly to reading from a file. We can write to a file by passing the <code class="docutils literal notranslate"><span class="pre">&quot;w&quot;</span></code> (“write”) mode as the second argument to <code class="docutils literal notranslate"><span class="pre">open</span></code> and calling the <code class="docutils literal notranslate"><span class="pre">write</span></code> method on the file object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;somefile.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Some content&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This will create a file <code class="docutils literal notranslate"><span class="pre">somefile.txt</span></code> with the content <code class="docutils literal notranslate"><span class="pre">&quot;Some</span> <span class="pre">content&quot;</span></code>. Note that if that file <em>already exists, it’s content will be completely overwritten by the new content</em>. If we want to avoid that and instead <em>append</em> the new content to the existing content we need to use the <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> (append) mode:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;somefile.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Some content&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="escape-characters">
<h2>Escape characters<a class="headerlink" href="#escape-characters" title="Permalink to this headline">#</a></h2>
<p>Some characters don’t denote letters, digits or special characters like <code class="docutils literal notranslate"><span class="pre">.</span></code>, <code class="docutils literal notranslate"><span class="pre">,</span></code> or <code class="docutils literal notranslate"><span class="pre">;</span></code> and need special treatment. The most important example of this is the <strong>newline character</strong>.</p>
<p>Remember that the file <code class="docutils literal notranslate"><span class="pre">example.txt</span></code> contains newlines which are correctly displayed when calling <code class="docutils literal notranslate"><span class="pre">print</span></code> on the file content. To find out how these newlines are represented, let’s get the <em>representation</em> of <code class="docutils literal notranslate"><span class="pre">content</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;Roses are red.\nViolets aren&#39;t blue.\nIt&#39;s literally in the name.\nThey&#39;re called violets.\n&quot;
</pre></div>
</div>
</div>
</div>
<p>If you are not inside a REPL, you will need to call the <code class="docutils literal notranslate"><span class="pre">repr</span></code> function manually.</p>
<p>As you can see newline characters are represented using <code class="docutils literal notranslate"><span class="pre">\n</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This a line.</span><span class="se">\n</span><span class="s2">This is another line.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This a line.
This is another line.
</pre></div>
</div>
</div>
</div>
<p>Another important character that gets special treatment is the <strong>tab character</strong> which is represented using <code class="docutils literal notranslate"><span class="pre">\t</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">first column</span><span class="se">\t</span><span class="s2">second column&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	first column	second column
</pre></div>
</div>
</div>
</div>
<p>The characters <code class="docutils literal notranslate"><span class="pre">\t</span></code> and <code class="docutils literal notranslate"><span class="pre">\n</span></code> are also called <strong>escape characters</strong>. Because a backslash is used for <em>escaping</em> characters, if you want to display backslashes in your strings, you might need to escape them as well resulting in <code class="docutils literal notranslate"><span class="pre">\\</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">t means tab&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>\t means tab
</pre></div>
</div>
</div>
</div>
<p>Escape characters also allow you to use quotes inside a string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="n">this</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">work</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="n">this</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">work</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="o">^</span>
<span class="ne">SyntaxError</span>: invalid syntax
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">this will work</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&quot;this will work&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="encodings">
<h2>Encodings<a class="headerlink" href="#encodings" title="Permalink to this headline">#</a></h2>
<p>Now that we have the basics out of the way, we need to have a look at how the content of file is actually stored on disk. To accomplish that we will pass yet another mode argument to <code class="docutils literal notranslate"><span class="pre">open</span></code>, namely <code class="docutils literal notranslate"><span class="pre">rb</span></code>. The <code class="docutils literal notranslate"><span class="pre">rb</span></code> mode means “read the file as a binary file” (<code class="docutils literal notranslate"><span class="pre">r</span></code> = read and <code class="docutils literal notranslate"><span class="pre">b</span></code> = binary):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;example.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>First of all we note that the content is no longer a string, but a <code class="docutils literal notranslate"><span class="pre">bytes</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b&quot;Roses are red.\nViolets aren&#39;t blue.\nIt&#39;s literally in the name.\nThey&#39;re called violets.\n&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bytes
</pre></div>
</div>
</div>
</div>
<p>This object contains the actual <em>bytes</em> of the file. A <strong>byte</strong> is simply the smallest unit of storage on a computer and can (usually) hold values from 0 to 255.</p>
<p>For example we access the <em>first byte</em> of the file like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82
</pre></div>
</div>
</div>
</div>
<p>Wait, why do we suddenly have numbers when we know that a file contains <em>characters</em>? The answer to this question is that the computer <em>deceptively lies to us</em>.</p>
<p>You see, computers can’t really store characters. They can <em>only store bytes</em>, i.e. essentially they store numbers from 0 to 255. This means that the file <em>actually contains a sequence of numbers</em>.</p>
<p>However computers maintain mappings from those numbers to characters, so that they can <em>interpret those numbers as characters</em>. The simplest such mapping is the <strong>ASCII table</strong>. Here is an excerpt from that table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">Byte</span> <span class="n">value</span> <span class="o">|</span> <span class="n">Character</span>        <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>        <span class="o">|</span> <span class="o">...</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">80</span>         <span class="o">|</span> <span class="n">P</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">81</span>         <span class="o">|</span> <span class="n">Q</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">82</span>         <span class="o">|</span> <span class="n">R</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">83</span>         <span class="o">|</span> <span class="n">S</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">84</span>         <span class="o">|</span> <span class="n">T</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">85</span>         <span class="o">|</span> <span class="n">U</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">86</span>         <span class="o">|</span> <span class="n">V</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">87</span>         <span class="o">|</span> <span class="n">W</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">88</span>         <span class="o">|</span> <span class="n">X</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">89</span>         <span class="o">|</span> <span class="n">Y</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">90</span>         <span class="o">|</span> <span class="n">Z</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>        <span class="o">|</span> <span class="o">...</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">97</span>         <span class="o">|</span> <span class="n">a</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">98</span>         <span class="o">|</span> <span class="n">b</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">99</span>         <span class="o">|</span> <span class="n">c</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">100</span>        <span class="o">|</span> <span class="n">d</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">101</span>        <span class="o">|</span> <span class="n">e</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>        <span class="o">|</span> <span class="o">...</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">110</span>        <span class="o">|</span> <span class="n">n</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">111</span>        <span class="o">|</span> <span class="n">o</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">112</span>        <span class="o">|</span> <span class="n">p</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">113</span>        <span class="o">|</span> <span class="n">q</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">114</span>        <span class="o">|</span> <span class="n">r</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="mi">115</span>        <span class="o">|</span> <span class="n">s</span>                <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
<span class="o">|</span> <span class="o">...</span>        <span class="o">|</span> <span class="o">...</span>              <span class="o">|</span>
<span class="o">|</span> <span class="n">__________</span> <span class="o">|</span> <span class="n">_________________</span><span class="o">|</span>
</pre></div>
</div>
<p>Now we can make some sense of the value of the <code class="docutils literal notranslate"><span class="pre">content</span></code> variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>82
</pre></div>
</div>
</div>
</div>
<p>If we look at the ASCII table, we can see that the number <code class="docutils literal notranslate"><span class="pre">82</span></code> corresponds to the character <code class="docutils literal notranslate"><span class="pre">R</span></code>. Therefore the first byte of the file contains the number <code class="docutils literal notranslate"><span class="pre">82</span></code> which represents the character <code class="docutils literal notranslate"><span class="pre">R</span></code>. The next few characters should be be <code class="docutils literal notranslate"><span class="pre">o</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code> and <code class="docutils literal notranslate"><span class="pre">s</span></code>, i.e. the following bytes should be <code class="docutils literal notranslate"><span class="pre">111</span></code>, <code class="docutils literal notranslate"><span class="pre">115</span></code>, <code class="docutils literal notranslate"><span class="pre">101</span></code> and <code class="docutils literal notranslate"><span class="pre">115</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>111
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>115
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>101
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>115
</pre></div>
</div>
</div>
</div>
<p>Characters like space, newline etc are also simply stored as bytes. For example the number corresponding to the space characters is <code class="docutils literal notranslate"><span class="pre">32</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>32
</pre></div>
</div>
</div>
</div>
<p>The ASCII table worked fine for a while until programmers suddenly noticed that there are languages in the world other than English. This was a truly <em>shocking</em> discovery that fundamentally changed the way programmers thought about the world. The <strong>Unicode</strong> standard was born.</p>
<blockquote>
<div><p>Note that this is really oversimplified history of the Unicode standard. The reality was much more complicated.</p>
</div></blockquote>
<p>The most important concept of the Unicode standard was the code point. A <strong>code point</strong> is a numerical value for a specific character. This is very similar to the ASCII table, except that Unicode is <em>much, much bigger</em> and contains such characters as:</p>
<ul class="simple">
<li><p>the German umlaut <code class="docutils literal notranslate"><span class="pre">ä</span></code> which has the code point 228</p></li>
<li><p>the checkmark <code class="docutils literal notranslate"><span class="pre">✅</span></code> which has the code point 9989</p></li>
<li><p>the emoji <code class="docutils literal notranslate"><span class="pre">😀</span></code> which has the code point 128512</p></li>
</ul>
<p>You can think of Unicode as a <em>giant</em> extension of the ASCII table.</p>
<p>The fact that Unicode is so large means we can no longer store every character in a single byte. In order to fit every Unicode character, we would need at least <em>four bytes</em>. However this would be extremely wasteful for e.g. english texts, since we would rarely <em>actually</em> need all four bytes in this case.</p>
<p>Therefore there are multiple <strong>encodings</strong> which govern how code points are <strong>encoded</strong> (i.e. converted) to bytes. For example an encoding can decide to represent some characters as a single byte, some characters as two bytes etc. We will not dive into the gritty details of encodings in this chapter since this is not essential to understand (at least not for know). But it <em>is essential</em> to realize that the <em>same code point</em> can be <em>converted to a different sequence of bytes depending on the encoding</em>.</p>
<p>Consider the German umlaut <code class="docutils literal notranslate"><span class="pre">ä</span></code> for example. The code point of <code class="docutils literal notranslate"><span class="pre">ä</span></code> is (always) 228, because that is the code point that was assigned to <code class="docutils literal notranslate"><span class="pre">ä</span></code>. However <em>different encodings</em> will represent this code point using <em>different byte sequences</em>.</p>
<p>For example the encoding <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> (which is the most popular encoding on the internet) will represent that code point using the following sequence of bytes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utf8_umlaut</span> <span class="o">=</span> <span class="s2">&quot;ä&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">utf8_umlaut</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utf8_umlaut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>195
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utf8_umlaut</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>164
</pre></div>
</div>
</div>
</div>
<p>However the <code class="docutils literal notranslate"><span class="pre">Windows-1252</span></code> encoding (called <code class="docutils literal notranslate"><span class="pre">cp1252</span></code> for short) which is commonly used on Windows systems represents the same code point completely differently:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp1252_umlaut</span> <span class="o">=</span> <span class="s2">&quot;ä&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;cp1252&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">cp1252_umlaut</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp1252_umlaut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>228
</pre></div>
</div>
</div>
</div>
<p>All of this has an extremely important practical consequence:</p>
<p><strong>If you want to know what string a sequence of bytes represents, you need to know the encoding of the string. The sequence of bytes by itself is (generally speaking) useless without the encoding.</strong></p>
<p>Consider the following sequence of bytes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">195</span><span class="p">,</span> <span class="mi">164</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>If that sequence of bytes has the encoding <code class="docutils literal notranslate"><span class="pre">utf-8</span></code> it represents the German umlaut <code class="docutils literal notranslate"><span class="pre">ä</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;ä&#39;
</pre></div>
</div>
</div>
</div>
<p>However if that sequence of bytes has the encoding <code class="docutils literal notranslate"><span class="pre">cp-1252</span></code> it suddenly represents a <em>completely different</em> string:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;cp-1252&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">LookupError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">38</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">b</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;cp-1252&quot;</span><span class="p">)</span>

<span class="ne">LookupError</span>: unknown encoding: cp-1252
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>It should be noted that if you don’t know the encoding of a string there are certain statistical methods that can be used to guess that encoding using common patterns. In addition there are some encodings that are much more common than the rest (like UTF-8 or Windows-1252). However this is all guessing and therefore not always accurate. This means that it is usually a bad idea to rely on such guesses when writing production code.</p>
</div></blockquote>
<p>This also means that if you write a file using one encoding and then try to read it using a different encoding, you will either get scrambled content or maybe even fail to read the file completely. This is actually a fairly common occurence if a file was created on an operating system that uses one encoding by default and then read on another operating system that uses another encoding by default.</p>
<p>Let’s see this in action. Create a text file <code class="docutils literal notranslate"><span class="pre">german.txt</span></code> with the following content:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="n">file</span> <span class="k">with</span> <span class="n">umlauts</span><span class="p">:</span> <span class="n">ÄÖÜäöü</span>
</pre></div>
</div>
<p>The encoding of the file should be <code class="docutils literal notranslate"><span class="pre">UTF-8</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;german.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">german_file</span><span class="p">:</span>
    <span class="n">german_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A file with umlauts: ÄÖÜäöü&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s try to read the same file using a different encoding:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;german.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;cp1252&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">german_file</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">german_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">content</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;A file with umlauts: Ã„Ã–ÃœÃ¤Ã¶Ã¼&#39;
</pre></div>
</div>
</div>
</div>
<p>Uh-oh! The content of this file is completely scrambled! This is because we tried to read it in an encoding that is different from the original encoding is was written in.</p>
<p>Depending on the encoding, the read may even fail <em>completely</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;german.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-16&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">german_file</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">german_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">UnicodeDecodeError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">42</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;german.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-16&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">german_file</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">content</span> <span class="o">=</span> <span class="n">german_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/codecs.py:322,</span> in <span class="ni">BufferedIncrementalDecoder.decode</span><span class="nt">(self, input, final)</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span> <span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">final</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>     <span class="c1"># decode input (taking the buffer into account)</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>     <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">+</span> <span class="nb">input</span>
<span class="ne">--&gt; </span><span class="mi">322</span>     <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">consumed</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer_decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="n">final</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>     <span class="c1"># keep undecoded input until the next call</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>     <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">consumed</span><span class="p">:]</span>

<span class="nn">File /opt/hostedtoolcache/Python/3.9.15/x64/lib/python3.9/encodings/utf_16.py:61,</span> in <span class="ni">IncrementalDecoder._buffer_decode</span><span class="nt">(self, input, errors, final)</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span> <span class="k">def</span> <span class="nf">_buffer_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="n">final</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">59</span>     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">60</span>         <span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">consumed</span><span class="p">,</span> <span class="n">byteorder</span><span class="p">)</span> <span class="o">=</span> \
<span class="ne">---&gt; </span><span class="mi">61</span>             <span class="n">codecs</span><span class="o">.</span><span class="n">utf_16_ex_decode</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">errors</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">final</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">62</span>         <span class="k">if</span> <span class="n">byteorder</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>             <span class="bp">self</span><span class="o">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">utf_16_le_decode</span>

<span class="ne">UnicodeDecodeError</span>: &#39;utf-16-le&#39; codec can&#39;t decode byte 0xbc in position 32: truncated data
</pre></div>
</div>
</div>
</div>
<p>This is actually better than scrambled content which represents a general principle in programming:</p>
<p><strong>It’s better to crash than to proceed with invalid data</strong>.</p>
<p>The reason for that is simple: If you crash, then at least you know you have an error. If you proceed with invalid data, then you may never know that you have an error until something really bad happens much later.</p>
<p>Consider a file that contains bank transactions. If you fail to read this file, then you know that your software has an error and you may try to fix it. But if you proceed with scrambled content, you may process completely wrong transactions resulting in <em>a lot</em> of headaches for <em>a lot</em> of people (including <em>you</em>).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./src/7-files"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../6-control-flow/chapter.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Chapter 6. Control flow</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../8-modules-and-packages/chapter.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Chapter 8. Modules and packages</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mikhail Berkov<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>